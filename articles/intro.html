<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction - Preprocessing and visualization of EEG data. • eeguana</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction - Preprocessing and visualization of EEG data.">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eeguana</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Introduction - Preprocessing and visualization of EEG data.</a>
    </li>
    <li>
      <a href="../articles/preprocessing_erp.html">Preprocessing of EEG data and computing ERPs (Fieldtrip tutorial)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bnicenboim/eeguana">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction - Preprocessing and visualization of EEG data.</h1>
                        <h4 class="author">Bruno Nicenboim</h4>
            
            <h4 class="date">2019-05-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bnicenboim/eeguana/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>The package <em>eeguana</em> provides a framework for doing simple pre-processing with specialized functions (starting with <code>eeg_</code> and <code>ch_</code>) and manipulating EEG data with <em>dplyr</em> verbs (e.g., <code>mutate</code>, <code>filter</code>, <code>summarize</code>) extended to a new class <code>eeg_lst</code>, and <code>ggplot</code> wrapper functions. The new class is inspired by tidyverse principles but it’s not really “tidy” (due to space considerations), it’s a list of (i) a wide table that contains the signal amplitudes at every sample point of the EEG, (ii) an events table with information about markers (or triggers), blinks and other exported information, and (iii) a long table with experimental information, such as participant (<code>recording</code>), conditions, etc.</p>
<p>While it’s possible to transform the <code>eeg_lst</code> to a <code>data.frame</code>, <code>data.table</code> or a <code>tibble</code> (with <code><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame()</a></code>, <code>as.data.table()</code> and <code><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble()</a></code>), the motivation for manipulating the data in the <code>eeg_lst</code> format has to do with size considerations. In this case, the original file was 113 MB, converting it to a long format entails a lot of repetition and generates an object of 556 MB. While this will still work here, a long format quickly becomes prohibitive in real settings with longer recordings.</p>
<div id="working-with-eeguana" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-eeguana" class="anchor"></a>Working with eeguana</h1>
<p>Dplyr verbs always return an <code>eeg_lst</code> object, which allows us to use <code>magrittr</code>’s pipe, <code>%&gt;%</code> (see <code>?`dplyr-eeguana`</code>). In addition, <code>eeg_</code>/<code>ch_</code> functions will also return an <code>eeg_lst</code> unless they have a suffix <code>_tbl</code> that indicates they return a data frame. In general, we will work with the <code>eeg_lst</code>, unless we want to modify the channels information (with <code><a href="../reference/channels_tbl.html">channels_tbl()</a></code>) or the events table containing markers, artifacts ans custom annotations (whith <code>events_tbl</code>).</p>
</div>
<div id="a-practical-example-the-n170-effect" class="section level1">
<h1 class="hasAnchor">
<a href="#a-practical-example-the-n170-effect" class="anchor"></a>A practical example: the N170 effect</h1>
<p>Here, I exemplify the use of <em>eeguana</em> with EEG data from BrainVision 1.0. The data belong to a simple experiment where a participant was presented 100 faces and 100 assorted images in random order. The task of the experiment was to mentally count the number of faces.</p>
<p>First we download the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/s1_faces.vhdr"</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="dt">mode =</span> <span class="st">"wb"</span>, <span class="dt">destfile =</span> <span class="st">"./s1_faces.vhdr"</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/s1_faces.vmrk"</span>,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">mode =</span> <span class="st">"wb"</span>, <span class="dt">destfile =</span> <span class="st">"./s1_faces.vmrk"</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/s1_faces.eeg"</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">mode =</span> <span class="st">"wb"</span>, <span class="dt">destfile =</span> <span class="st">"./s1_faces.eeg"</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">)</a></code></pre></div>
<p>BrainVision 1.0 exports three files: <code>s1_faces.vhdr</code>, <code>s1_faces.vmrk</code>, and <code>s1_faces.eeg</code>. The file <code>s1_faces.vhdr</code> contains the metadata and links to the other two files, <code>s1_faces.vmrk</code> contains the triggers and other events in the samples, and <code>s1_faces.eeg</code> contains the signals at every sample for every channel recorded.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(eeguana)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>) <span class="co"># ICA will always find the same components</span></a></code></pre></div>
<p>We first need to read the data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">faces &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_vhdr.html">read_vhdr</a></span>(<span class="st">"s1_faces.vhdr"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Reading file s1_faces.vhdr...</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; # Data from s1_faces.eeg was read.</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; # Data from 1 segment(s) and 34 channels was loaded.</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; # Object size in memory 113.4 Mb</span></a></code></pre></div>
<p>The function <code><a href="../reference/read_vhdr.html">read_vhdr()</a></code> creates a list with data frames for the signal, events, segments information, and incorporates in its attributes generic EEG information.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">faces</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; # EEG data:</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; # Signal table:</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;         .id .sample       Fp1       Fpz       Fp2        F7         F3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;      1:   1       1 -17878.56 -8921.395 -14028.81 -284.2541 -1378.1467</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;      2:   1       2 -17903.75 -8948.022 -14056.53 -303.9134 -1400.6560</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;      3:   1       3 -17916.55 -8961.906 -14070.91 -307.1683 -1407.8466</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;      4:   1       4 -17918.17 -8963.691 -14068.63 -299.8859 -1401.9985</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;      5:   1       5 -17917.71 -8965.658 -14069.16 -294.7915 -1401.2996</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;     ---                                                               </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 424484:   1  424484 -16094.71 -8234.730 -13505.21  609.9043  -236.9552</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; 424485:   1  424485 -16140.11 -8280.301 -13547.56  603.1918  -311.0485</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; 424486:   1  424486 -16145.24 -8275.078 -13528.22  541.3096  -291.0218</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 424487:   1  424487 -16165.22 -8294.479 -13546.50  467.7130  -302.0740</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 424488:   1  424488 -16167.39 -8305.199 -13561.12  576.3062  -319.2688</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;                Fz       F4         F8       FC5       FC1       FC2       FC6</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;      1: -8077.128 1167.489 -1663.4490 -2315.080 -9040.689 -795.0549 -3665.146</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;      2: -8101.660 1145.292 -1685.9034 -2338.859 -9064.137 -816.1298 -3688.133</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;      3: -8114.331 1138.028 -1691.4203 -2343.475 -9071.438 -823.4675 -3690.046</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;      4: -8116.114 1139.702 -1683.0713 -2333.746 -9065.608 -817.9690 -3681.642</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;      5: -8119.442 1136.373 -1684.2664 -2326.648 -9061.397 -817.2882 -3679.563</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;     ---                                                                      </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; 424484: -7991.669 1977.146  -162.8618 -2290.511 -9349.164 -318.8641 -2805.395</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; 424485: -8045.019 1938.122  -183.0542 -2424.133 -9410.679 -364.1038 -2833.090</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; 424486: -8032.237 1965.358  -132.3712 -2291.431 -9379.728 -342.3297 -2811.445</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; 424487: -8052.393 1930.877  -180.4978 -2361.589 -9381.456 -358.2924 -2868.325</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; 424488: -8065.579 1927.474  -188.0929 -2368.595 -9409.171 -363.8277 -2853.797</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;         M1        T7        C3         Cz        C4         T8        M2</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;      1:  0 -5156.998 -2466.320 -1568.4097 -4427.577 -10351.511 -1845.363</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;      2:  0 -5184.417 -2490.411 -1591.3053 -4450.049 -10372.402 -1850.862</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;      3:  0 -5186.146 -2495.726 -1597.7970 -4454.775 -10378.323 -1845.087</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;      4:  0 -5174.358 -2487.358 -1591.5627 -4449.590 -10373.983 -1836.370</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;      5:  0 -5170.146 -2481.878 -1588.5833 -4446.334 -10370.489 -1841.961</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;     ---                                                                 </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; 424484:  0 -3703.158 -2301.288  -395.4219 -2952.459  -9502.499 -2128.771</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; 424485:  0 -3834.959 -2372.439  -444.3945 -2994.426  -9465.224 -2179.546</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; 424486:  0 -3773.260 -2312.064  -419.6414 -2975.410  -9389.198 -2153.340</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; 424487:  0 -3746.392 -2304.304  -426.3353 -2986.242  -9369.264 -2141.644</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt; 424488:  0 -3615.768 -2358.720  -437.9209 -2984.145  -9521.864 -2130.978</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt;               CP5       CP1        CP2       CP6        P7        P3         Pz</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt;      1: -8938.128 -4755.838 -1369.6688 -1729.708 -7513.455 -8512.474 -537.63159</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt;      2: -8963.231 -4778.917 -1391.3324 -1750.029 -7535.836 -8533.438 -557.97095</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt;      3: -8969.171 -4784.986 -1397.7506 -1757.532 -7541.739 -8537.741 -561.55725</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt;      4: -8957.989 -4775.938 -1391.9026 -1754.553 -7530.282 -8529.099 -552.78510</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt;      5: -8950.726 -4772.205 -1388.7207 -1755.197 -7524.361 -8523.562 -549.19885</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt;     ---                                                                        </span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt; 424484: -8037.571 -4200.332  -677.7635 -1046.501 -5433.473 -8150.485  -34.94090</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt; 424485: -8083.840 -4253.405  -721.7708 -1080.431 -5470.565 -8197.932  -79.35287</span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; 424486: -8027.603 -4225.636  -702.5348 -1048.874 -5474.501 -8173.215  -60.83399</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt; 424487: -8046.398 -4230.160  -709.1735 -1040.856 -5488.533 -8182.244  -64.40166</span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"><span class="co">#&gt; 424488: -8060.742 -4244.541  -712.0606 -1053.931 -5478.491 -8187.780  -69.53255</span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt;                 P4        P8       POz        O1        Oz        O2      HEOG</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="co">#&gt;      1:  -99.10343 -875.6397 -852.6708 -4117.080 -1950.149 -817.4540 -5006.420</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="co">#&gt;      2: -117.14455 -892.3933 -871.1710 -4136.997 -1965.578 -825.3984 -5027.017</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co">#&gt;      3: -122.82701 -892.9816 -873.9114 -4138.725 -1965.137 -824.5893 -5037.775</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt;      4: -117.75130 -886.6740 -866.0771 -4126.606 -1957.450 -823.7434 -5033.031</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"><span class="co">#&gt;      5: -117.82441 -885.3681 -865.5070 -4127.543 -1967.270 -834.0415 -5031.210</span></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="co">#&gt;     ---                                                                       </span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co">#&gt; 424484:  496.89807 -182.1897 -304.2810 -2730.290 -1170.744  -67.8408 -3137.224</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="co">#&gt; 424485:  458.84891 -229.4153 -345.6953 -2777.571 -1209.235 -104.1242 -3216.466</span></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="co">#&gt; 424486:  476.24600 -226.5095 -342.8815 -2794.121 -1232.792 -135.4974 -3136.874</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co">#&gt; 424487:  471.66693 -247.6580 -343.4331 -2790.444 -1224.516 -152.9679 -3105.096</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"><span class="co">#&gt; 424488:  475.47369 -247.5108 -350.5685 -2804.640 -1245.077 -186.8792 -3162.988</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co">#&gt;              VEOG</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="co">#&gt;      1: -9116.806</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"><span class="co">#&gt;      2: -9133.780</span></a>
<a class="sourceLine" id="cb4-68" data-line-number="68"><span class="co">#&gt;      3: -9138.781</span></a>
<a class="sourceLine" id="cb4-69" data-line-number="69"><span class="co">#&gt;      4: -9134.222</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"><span class="co">#&gt;      5: -9139.996</span></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co">#&gt;     ---          </span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"><span class="co">#&gt; 424484: -8591.514</span></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="co">#&gt; 424485: -8672.283</span></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"><span class="co">#&gt; 424486: -8648.578</span></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"><span class="co">#&gt; 424487: -8658.159</span></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"><span class="co">#&gt; 424488: -8660.311</span></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="co">#&gt; # Events table:</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"><span class="co">#&gt;      .id       .type .description .initial .final .channel</span></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co">#&gt;   1:   1 New Segment                     1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co">#&gt;   2:   1    Stimulus         s111    10528  10528     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co">#&gt;   3:   1    Stimulus         s130    10742  10742     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co">#&gt;   4:   1    Stimulus          s71    11175  11175     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co">#&gt;   5:   1    Stimulus         s130    12806  12806     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"><span class="co">#&gt;  ---                                                      </span></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"><span class="co">#&gt; 401:   1    Stimulus         s130   411197 411197     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">#&gt; 402:   1    Stimulus          s71   411469 411469     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="co">#&gt; 403:   1    Stimulus         s121   412943 412943     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-89" data-line-number="89"><span class="co">#&gt; 404:   1    Stimulus         s122   412966 412966     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">#&gt; 405:   1    Stimulus         s102   412989 412989     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92"><span class="co">#&gt; # Segments table:</span></a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94"><span class="co">#&gt;     .id .recording    segment</span></a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"><span class="co">#&gt; 1     1 s1_faces.vhdr       1</span></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(faces)</a>
<a class="sourceLine" id="cb4-98" data-line-number="98"><span class="co">#&gt; # EEG data:</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="co">#&gt; # Sampling rate: 512 Hz.</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"><span class="co">#&gt; # Size in memory: 113.4 Mb.</span></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">#&gt; # Total duration: 00:13:49.</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102"><span class="co">#&gt; # Summary of segments</span></a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co">#&gt;       .recording n_segments n_incomplete</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104"><span class="co">#&gt; 1: s1_faces.vhdr          1            0</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"><span class="co">#&gt; # Summary of events</span></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"><span class="co">#&gt;          .type .description   n</span></a>
<a class="sourceLine" id="cb4-107" data-line-number="107"><span class="co">#&gt; 1: New Segment                1</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108"><span class="co">#&gt; 2:    Stimulus         s102   1</span></a>
<a class="sourceLine" id="cb4-109" data-line-number="109"><span class="co">#&gt; 3:    Stimulus         s111   1</span></a>
<a class="sourceLine" id="cb4-110" data-line-number="110"><span class="co">#&gt; 4:    Stimulus         s121   1</span></a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">#&gt; 5:    Stimulus         s122   1</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112"><span class="co">#&gt; 6:    Stimulus         s130 200</span></a>
<a class="sourceLine" id="cb4-113" data-line-number="113"><span class="co">#&gt; 7:    Stimulus          s70 100</span></a>
<a class="sourceLine" id="cb4-114" data-line-number="114"><span class="co">#&gt; 8:    Stimulus          s71 100</span></a></code></pre></div>
<p>We see that there is no electrode positions in the object, but since we know that the layout was a standard 10/20, we’ll add this layout to the object, using the dataset <code>layout_32_1020</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/channels_tbl.html">channels_tbl</a></span>(faces)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 34 x 11</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;    .channel number .reference resolution unit  radius theta   phi    .x    .y</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  1 Fp1      Ch1    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;  2 Fpz      Ch2    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  3 Fp2      Ch3    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;  4 F7       Ch4    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;  5 F3       Ch5    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  6 Fz       Ch6    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  7 F4       Ch7    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;  8 F8       Ch8    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  9 FC5      Ch9    ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 10 FC1      Ch10   ""                  1 micr…     NA    NA    NA    NA    NA</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; # … with 24 more rows, and 1 more variable: .z &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## In case the order of the electrodes is different, we do a left_join instead of replacing the table:</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="kw"><a href="../reference/channels_tbl.html">channels_tbl</a></span>(faces) &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw"><a href="../reference/channels_tbl.html">channels_tbl</a></span>(faces), .channel) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(layout_<span class="dv">32</span>_<span class="dv">1020</span>)</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; Joining, by = ".channel"</span></a></code></pre></div>
<p>The plots that <strong>eeguana</strong> produce are <code>ggplot</code> objects that can be modified like regular <code>ggplot</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(faces) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">"All the experiment"</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; # Downsampling from 512Hz to 3.05Hz.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; # Using the following factor(s) q: 3, 2, 7, 4</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; # Object size in memory 760.1 Kb</span></a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div id="pre-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-processing" class="anchor"></a>Pre-processing</h2>
<div id="rereferencing" class="section level3">
<h3 class="hasAnchor">
<a href="#rereferencing" class="anchor"></a>Rereferencing</h3>
<p>In this dataset, the signal from all electrodes is monopolar and referenced to the left mastoid (M1). We want the signal (excluding the EOG channels) to be referenced to linked (left and right) mastoids (M1 and M2).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">faces &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_rereference.html">eeg_rereference</a></span>(faces, <span class="op">-</span>VEOG, <span class="op">-</span>HEOG, <span class="dt">ref =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"M1"</span>, <span class="st">"M2"</span>))</a></code></pre></div>
</div>
</div>
<div id="filtering" class="section level2">
<h2 class="hasAnchor">
<a href="#filtering" class="anchor"></a>Filtering</h2>
<p>We apply a band pass filter of 0.1 to 30 Hz to all the channels except the EOG channels, where we apply a stronger filter to be able to detect eye movements later. We don’t segment yet, because discontinuities in the signal create artifacts on the edges.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">faces_filt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/filt.html">eeg_filt_band_pass</a></span>(faces, <span class="op">-</span>HEOG, <span class="op">-</span>VEOG, <span class="dt">freq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">1</span>, <span class="dv">30</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/filt.html">eeg_filt_band_pass</a></span>(HEOG, VEOG, <span class="dt">freq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; Setting up band-pass filter from 0.1 - 30 Hz</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; Setting up band-pass filter from 1 - 10 Hz</span></a></code></pre></div>
</div>
<div id="ica" class="section level2">
<h2 class="hasAnchor">
<a href="#ica" class="anchor"></a>ICA</h2>
<p>We want to apply ICA to as much data as possible, but to “representative” data, that is part of the experiments and not when the participants are moving or reading the instructions. For the same reason, we want to the ignore “crazy” artifacts: regions with extreme amplitudes in the signal.</p>
<p>We first cut a large segment that excludes data before and after the experiment was ran using <code><a href="../reference/eeg_segment.html">eeg_segment()</a></code> (that is, only data from the marker “s111” to “s121”), and then we mark differences of 100 microvolts between peaks with <code><a href="../reference/eeg_artif.html">eeg_artif_minmax()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">faces_ls &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_segment.html">eeg_segment</a></span>(faces_filt, .description <span class="op">==</span><span class="st"> "s111"</span>, <span class="dt">end =</span> .description <span class="op">==</span><span class="st"> "s121"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/eeg_artif.html">eeg_artif_minmax</a></span>(<span class="op">-</span>HEOG, <span class="op">-</span>VEOG, <span class="dt">threshold =</span> <span class="dv">200</span>, <span class="dt">window =</span> <span class="dv">200</span>, <span class="dt">unit =</span> <span class="st">"ms"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; # Total of 1 segments found.</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; # Object size in memory 107.5 Mb after segmentation.</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; # Number of intervals with artifacts: 118</span></a></code></pre></div>
<p><code>eeg_artif_minimax()</code> only adds the artifacts in the events table, and doesn’t modify the signal. We can have a look at the type of artifacts that were detected, by plotting the signal and the events with <code><a href="../reference/annotate_events.html">annotate_events()</a></code>. It would be a good idea to just check a couple of seconds of the signal, for that we use the <code>dplyr</code> “verb” <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> which is overloaded to work with <code>eeg_lst</code>s.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">faces_ls <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="../reference/as_time.html">as_time</a></span>(.sample, <span class="dt">unit =</span> <span class="st">"s"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/between.html">between</a></span>(<span class="dv">0</span>, <span class="dv">90</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/annotate_events.html">annotate_events</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; # Downsampling from 512Hz to 28.44Hz.</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; # Using the following factor(s) q: 9, 2</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; # Object size in memory 764.3 Kb</span></a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>Now we can run ICA, removing the EOG and reference electrodes, and ignoring the artifacts.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">## By default will ignore artifacts</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">faces_ica &lt;-<span class="st"> </span>faces_ls <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/eeg_ica.html">eeg_ica</a></span>(<span class="op">-</span>HEOG, <span class="op">-</span>VEOG, <span class="op">-</span>M1, <span class="op">-</span>M2, <span class="dt">method =</span> adapt_fast_ICA, <span class="dt">ignore =</span> .type <span class="op">==</span><span class="st"> "artifact"</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # ICA is being done using adapt_fast_ICA...</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; # ICA took 2.93 mins</span></a></code></pre></div>
<p>We can now check the different topographic plots of the ICAs with <code><a href="../reference/plot_components.html">plot_components()</a></code>, and their correlation with the EOG channels looking a the summary of the object.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">faces_ica <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_components.html">plot_components</a></span>()</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(faces_ica)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; # EEG data:</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; # Sampling rate: 512 Hz.</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; # Size in memory: 107.6 Mb.</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; # Total duration: 00:13:05.</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; # Summary of segments</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt;       .recording n_segments n_incomplete</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt; 1: s1_faces.vhdr          1            0</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; # Summary of events</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;       .type                    .description   n</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; 1: artifact minmax_threshold=200_window=102 118</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; 2: Stimulus                            s111   1</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; 3: Stimulus                            s121   1</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; 4: Stimulus                            s130 200</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; 5: Stimulus                             s70 100</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; 6: Stimulus                             s71 100</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; # ICA data:</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt; # Correlations with EOG channels:</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; $HEOG</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#&gt; # A tibble: 30 x 2</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#&gt;    .ICA      cor</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">#&gt;  1 ICA1  -0.679 </span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#&gt;  2 ICA25  0.121 </span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#&gt;  3 ICA24 -0.105 </span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">#&gt;  4 ICA14  0.0875</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co">#&gt;  5 ICA26 -0.0854</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co">#&gt;  6 ICA5   0.0812</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co">#&gt;  7 ICA10  0.0698</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">#&gt;  8 ICA13  0.0669</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="co">#&gt;  9 ICA9   0.0658</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="co">#&gt; 10 ICA21  0.0649</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="co">#&gt; # … with 20 more rows</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="co">#&gt; $VEOG</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="co">#&gt; # A tibble: 30 x 2</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="co">#&gt;    .ICA      cor</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-41" data-line-number="41"><span class="co">#&gt;  1 ICA5   0.846 </span></a>
<a class="sourceLine" id="cb13-42" data-line-number="42"><span class="co">#&gt;  2 ICA3   0.208 </span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43"><span class="co">#&gt;  3 ICA1   0.204 </span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44"><span class="co">#&gt;  4 ICA22 -0.189 </span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"><span class="co">#&gt;  5 ICA13 -0.172 </span></a>
<a class="sourceLine" id="cb13-46" data-line-number="46"><span class="co">#&gt;  6 ICA14  0.133 </span></a>
<a class="sourceLine" id="cb13-47" data-line-number="47"><span class="co">#&gt;  7 ICA30 -0.107 </span></a>
<a class="sourceLine" id="cb13-48" data-line-number="48"><span class="co">#&gt;  8 ICA16  0.0940</span></a>
<a class="sourceLine" id="cb13-49" data-line-number="49"><span class="co">#&gt;  9 ICA23 -0.0723</span></a>
<a class="sourceLine" id="cb13-50" data-line-number="50"><span class="co">#&gt; 10 ICA24 -0.0553</span></a>
<a class="sourceLine" id="cb13-51" data-line-number="51"><span class="co">#&gt; # … with 20 more rows</span></a></code></pre></div>
<p>We’ll look closer at the ICA that are more likely to be related to eye movements, and we’ll compare with signals that look like blinks and saccades:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">ICAs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ICA1"</span>, <span class="st">"ICA2"</span>, <span class="st">"ICA3"</span>, <span class="st">"ICA4"</span>, <span class="st">"ICA5"</span>, <span class="st">"ICA6"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">faces_ica_b &lt;-<span class="st"> </span>faces_ica <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/eeg_artif.html">eeg_artif_step</a></span>(HEOG, <span class="dt">threshold =</span> <span class="dv">30</span>, <span class="dt">window =</span> <span class="dv">200</span>, <span class="dt">unit =</span> <span class="st">"ms"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/eeg_artif.html">eeg_artif_minmax</a></span>(VEOG, <span class="dt">threshold =</span> <span class="dv">50</span>, <span class="dt">window =</span> <span class="dv">200</span>, <span class="dt">unit =</span> <span class="st">"ms"</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; # Number of intervals with artifacts: 194</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; # Number of intervals with artifacts: 220</span></a></code></pre></div>
<p>We don’t want to plot everything, so we’ll produce the most promising components with <code>eeg_ica_show</code>, and we’ll use some dplyr-verbs to see only a piece of the signal (with <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>), to select the desired components and the eye channels (with <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>), and to enlarge the components (because their amplitude is much smaller than EOG channels and it will be difficult to see)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">faces_ica_b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="co">## we take a 200 seconds of the signal:</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="../reference/as_time.html">as_time</a></span>(.sample) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/between.html">between</a></span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="co">## we produce some components for this piece</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/eeg_ica_show.html">eeg_ica_show</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(ICAs)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st">  </span><span class="co">## we select want we want to show:</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(ICAs, <span class="st">"VEOG"</span>, <span class="st">"HEOG"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">  </span><span class="co">## we enlarge the components</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span>(is_component_dbl, <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="st">  </span><span class="co">## finally we plot here:</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="../reference/annotate_events.html">annotate_events</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; # Downsampling from 512Hz to 12.19Hz.</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt; # Using the following factor(s) q: 7, 6</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; # Object size in memory 214.8 Kb</span></a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p>The clearest ones are the ICA1, ICA2, and ICA3, and so we’ll just remove that ones.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">faces_icaed &lt;-<span class="st"> </span>faces_ica <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/eeg_ica_keep.html">eeg_ica_keep</a></span>(<span class="op">-</span>ICA1, <span class="op">-</span>ICA5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/as_eeg_lst.html">as_eeg_lst</a></span>()</a></code></pre></div>
<p>Now we’ll segment the data to appropriate check if there are still artifacts.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/events_tbl.html">events_tbl</a></span>(faces_icaed) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/events_tbl.html">events_tbl</a></span>(faces_icaed) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span>.type <span class="op">%in%</span><span class="st"> "artifact"</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">faces_seg &lt;-<span class="st"> </span>faces_icaed <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>description, <span class="op">-</span>type) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/eeg_segment.html">eeg_segment</a></span>(.description <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"s70"</span>, <span class="st">"s71"</span>), <span class="dt">lim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; # Total of 200 segments found.</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt; # Object size in memory 16.5 Mb after segmentation.</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">faces_seg_artif &lt;-<span class="st"> </span>faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="../reference/eeg_artif.html">eeg_artif_minmax</a></span>(<span class="op">-</span>HEOG, <span class="op">-</span>VEOG, <span class="dt">threshold =</span> <span class="dv">100</span>, <span class="dt">window =</span> <span class="dv">150</span>, <span class="dt">unit =</span> <span class="st">"ms"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="../reference/eeg_artif.html">eeg_artif_step</a></span>(<span class="op">-</span>HEOG, <span class="op">-</span>VEOG, <span class="dt">threshold =</span> <span class="dv">50</span>, <span class="dt">window =</span> <span class="dv">200</span>, <span class="dt">unit =</span> <span class="st">"ms"</span>)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#&gt; # Number of intervals with artifacts: 0</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#&gt; # Number of intervals with artifacts: 2</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"></a>
<a class="sourceLine" id="cb17-16" data-line-number="16">bad &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="../reference/events_tbl.html">events_tbl</a></span>(faces_seg_artif), .type <span class="op">==</span><span class="st"> "artifact"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(.id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>()</a>
<a class="sourceLine" id="cb17-17" data-line-number="17">faces_seg_artif <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(.id <span class="op">==</span><span class="st"> </span>bad) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>VEOG, <span class="op">-</span>HEOG) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="../reference/annotate_events.html">annotate_events</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">faces_seg &lt;-<span class="st"> </span>faces_seg_artif <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/eeg_events_to_NA.html">eeg_events_to_NA</a></span>(.type <span class="op">==</span><span class="st"> "artifact"</span>, <span class="dt">entire_seg =</span> <span class="ot">TRUE</span>, <span class="dt">all_chs =</span> <span class="ot">FALSE</span>, <span class="dt">drop_events =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(faces_seg)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; # EEG data:</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; # Sampling rate: 512 Hz.</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; # Size in memory: 16.5 Mb.</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; # Total duration: 00:02:00.</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; # Summary of segments</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt;       .recording n_segments n_incomplete</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; 1: s1_faces.vhdr        200            1</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; # Summary of events</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt;       .type .description   n</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; 1: Stimulus          s70 100</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; 2: Stimulus          s71 100</span></a></code></pre></div>
<p>Finally, we can baseline the segments:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">faces_seg &lt;-<span class="st"> </span>faces_seg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/eeg_baseline.html">eeg_baseline</a></span>()</a></code></pre></div>
</div>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>We edit the segmentation information and add more descriptive labels.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">faces_seg &lt;-<span class="st"> </span>faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">    <span class="dt">condition =</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">      <span class="kw"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span>(description <span class="op">==</span><span class="st"> "s70"</span>, <span class="st">"faces"</span>, <span class="st">"non-faces"</span>)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>type)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">faces_seg</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; # EEG data:</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; # Signal table:</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt;        .id .sample        Fp1       Fpz        Fp2         F7       F3</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt;     1:   1     -50 -0.7196580  2.759307  0.3450389 -1.4088708 3.374299</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt;     2:   1     -49  0.4893722  3.738851  1.0007048 -0.6136137 3.609363</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt;     3:   1     -48  1.7099243  4.671520  1.7692238  0.3602256 3.886544</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt;     4:   1     -47  2.7684216  5.405270  2.4914127  1.4268524 4.163023</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt;     5:   1     -46  3.5123990  5.811090  3.0188233  2.5040193 4.407435</span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt;    ---                                                                </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; 61596: 200     253 -4.5174001 -3.048146 -4.7281674 10.1911850 6.647471</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; 61597: 200     254 -3.9951366 -3.061167 -5.1472917  9.2225132 5.898219</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 61598: 200     255 -3.3048688 -3.080869 -5.5520331  8.3100695 5.255760</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; 61599: 200     256 -2.6220511 -3.172196 -5.9692772  7.4213202 4.659662</span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt; 61600: 200     257 -2.1346583 -3.398437 -6.4368210  6.5022052 4.017326</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="co">#&gt;                Fz         F4          F8       FC5       FC1        FC2</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="co">#&gt;     1:   4.145462   3.148020  -1.8678543 0.9494174  1.396600  -2.295472</span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="co">#&gt;     2:   4.185316   2.698146  -1.0354342 1.3619192  1.659591  -2.791381</span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="co">#&gt;     3:   4.331762   2.347362   0.1497221 1.7331089  2.006785  -3.048539</span></a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="co">#&gt;     4:   4.496402   2.062170   1.5260817 2.0506075  2.391170  -3.088335</span></a>
<a class="sourceLine" id="cb20-29" data-line-number="29"><span class="co">#&gt;     5:   4.603069   1.814833   2.9223061 2.3270911  2.774484  -2.934341</span></a>
<a class="sourceLine" id="cb20-30" data-line-number="30"><span class="co">#&gt;    ---                                                                 </span></a>
<a class="sourceLine" id="cb20-31" data-line-number="31"><span class="co">#&gt; 61596:  -8.244183 -13.975129  -8.9200973 8.5855167 -2.556791 -19.409422</span></a>
<a class="sourceLine" id="cb20-32" data-line-number="32"><span class="co">#&gt; 61597:  -8.950615 -13.711210  -9.9805965 7.5155864 -3.768546 -19.876743</span></a>
<a class="sourceLine" id="cb20-33" data-line-number="33"><span class="co">#&gt; 61598:  -9.469326 -13.380067 -10.8043484 6.3954286 -5.086511 -20.264585</span></a>
<a class="sourceLine" id="cb20-34" data-line-number="34"><span class="co">#&gt; 61599:  -9.839479 -13.005664 -11.3855542 5.2179114 -6.483273 -20.574810</span></a>
<a class="sourceLine" id="cb20-35" data-line-number="35"><span class="co">#&gt; 61600: -10.129034 -12.624390 -11.7382203 3.9567841 -7.943093 -20.822115</span></a>
<a class="sourceLine" id="cb20-36" data-line-number="36"><span class="co">#&gt;                FC6        M1       T7         C3         Cz          C4</span></a>
<a class="sourceLine" id="cb20-37" data-line-number="37"><span class="co">#&gt;     1:  -1.2265143 -2.030141 8.253891 -2.2692661  -5.756678  -0.6386102</span></a>
<a class="sourceLine" id="cb20-38" data-line-number="38"><span class="co">#&gt;     2:  -0.5175638 -1.922150 8.567596 -2.3869240  -5.904498  -1.1213988</span></a>
<a class="sourceLine" id="cb20-39" data-line-number="39"><span class="co">#&gt;     3:   0.4669961 -1.785010 8.399222 -2.4886989  -5.770324  -1.5923373</span></a>
<a class="sourceLine" id="cb20-40" data-line-number="40"><span class="co">#&gt;     4:   1.5999064 -1.654058 7.787650 -2.5429509  -5.382069  -2.0251474</span></a>
<a class="sourceLine" id="cb20-41" data-line-number="41"><span class="co">#&gt;     5:   2.7601396 -1.545839 6.826330 -2.5055904  -4.776398  -2.3730794</span></a>
<a class="sourceLine" id="cb20-42" data-line-number="42"><span class="co">#&gt;    ---                                                                 </span></a>
<a class="sourceLine" id="cb20-43" data-line-number="43"><span class="co">#&gt; 61596: -16.0129368  4.310870 8.038155  0.9859522 -14.587902 -35.6717209</span></a>
<a class="sourceLine" id="cb20-44" data-line-number="44"><span class="co">#&gt; 61597: -17.0540548  4.454409 7.915414 -0.5386313 -15.983657 -36.4573343</span></a>
<a class="sourceLine" id="cb20-45" data-line-number="45"><span class="co">#&gt; 61598: -18.0307189  4.482182 7.638785 -2.2261064 -17.525739 -37.1771981</span></a>
<a class="sourceLine" id="cb20-46" data-line-number="46"><span class="co">#&gt; 61599: -18.8883871  4.394789 7.120897 -4.0084017 -19.124941 -37.8044267</span></a>
<a class="sourceLine" id="cb20-47" data-line-number="47"><span class="co">#&gt; 61600: -19.5813461  4.203761 6.293197 -5.8327858 -20.694241 -38.3088380</span></a>
<a class="sourceLine" id="cb20-48" data-line-number="48"><span class="co">#&gt;                T8        M2         CP5        CP1        CP2         CP6</span></a>
<a class="sourceLine" id="cb20-49" data-line-number="49"><span class="co">#&gt;     1:   4.411867  2.030141  1.89720992  -5.670715  -3.913878   2.2268681</span></a>
<a class="sourceLine" id="cb20-50" data-line-number="50"><span class="co">#&gt;     2:   5.992174  1.922150  1.40468412  -5.796751  -4.455980   1.6386382</span></a>
<a class="sourceLine" id="cb20-51" data-line-number="51"><span class="co">#&gt;     3:   7.614405  1.785010  0.72521016  -5.786085  -4.853464   1.0359176</span></a>
<a class="sourceLine" id="cb20-52" data-line-number="52"><span class="co">#&gt;     4:   8.976447  1.654058 -0.03981994  -5.635499  -5.090930   0.4340056</span></a>
<a class="sourceLine" id="cb20-53" data-line-number="53"><span class="co">#&gt;     5:   9.783797  1.545839 -0.76970390  -5.336744  -5.152129  -0.1362994</span></a>
<a class="sourceLine" id="cb20-54" data-line-number="54"><span class="co">#&gt;    ---                                                                   </span></a>
<a class="sourceLine" id="cb20-55" data-line-number="55"><span class="co">#&gt; 61596: -28.768359 -4.310870  5.05458361  -4.442662 -31.817609 -30.6066626</span></a>
<a class="sourceLine" id="cb20-56" data-line-number="56"><span class="co">#&gt; 61597: -30.064498 -4.454409  4.09258379  -5.964765 -33.102451 -31.6523181</span></a>
<a class="sourceLine" id="cb20-57" data-line-number="57"><span class="co">#&gt; 61598: -30.937948 -4.482182  2.89345138  -7.703163 -34.334384 -32.6971179</span></a>
<a class="sourceLine" id="cb20-58" data-line-number="58"><span class="co">#&gt; 61599: -31.389554 -4.394789  1.50025284  -9.548284 -35.425787 -33.7301306</span></a>
<a class="sourceLine" id="cb20-59" data-line-number="59"><span class="co">#&gt; 61600: -31.439194 -4.203761 -0.04682639 -11.394028 -36.291994 -34.7092329</span></a>
<a class="sourceLine" id="cb20-60" data-line-number="60"><span class="co">#&gt;                P7         P3         Pz          P4          P8       POz</span></a>
<a class="sourceLine" id="cb20-61" data-line-number="61"><span class="co">#&gt;     1: -2.0317901 -2.7944554  -3.241938  -0.6783762   0.6526893 -1.283504</span></a>
<a class="sourceLine" id="cb20-62" data-line-number="62"><span class="co">#&gt;     2: -2.8017583 -3.3464857  -3.841418  -1.4711055  -1.7403654 -2.448701</span></a>
<a class="sourceLine" id="cb20-63" data-line-number="63"><span class="co">#&gt;     3: -3.3625560 -3.8187280  -4.396698  -2.1838923  -3.9970489 -3.554637</span></a>
<a class="sourceLine" id="cb20-64" data-line-number="64"><span class="co">#&gt;     4: -3.6493206 -4.1456073  -4.870308  -2.7624575  -5.8406820 -4.497626</span></a>
<a class="sourceLine" id="cb20-65" data-line-number="65"><span class="co">#&gt;     5: -3.6301192 -4.2663962  -5.219345  -3.1545011  -7.0380085 -5.183308</span></a>
<a class="sourceLine" id="cb20-66" data-line-number="66"><span class="co">#&gt;    ---                                                                   </span></a>
<a class="sourceLine" id="cb20-67" data-line-number="67"><span class="co">#&gt; 61596:  3.7944482  3.6211732 -12.195073 -27.5117393 -23.3979599 -5.448576</span></a>
<a class="sourceLine" id="cb20-68" data-line-number="68"><span class="co">#&gt; 61597:  3.4652648  2.5257150 -13.412815 -28.1509935 -23.3631605 -6.249241</span></a>
<a class="sourceLine" id="cb20-69" data-line-number="69"><span class="co">#&gt; 61598:  2.7480711  1.2294552 -14.665629 -28.6329868 -22.5144761 -7.081719</span></a>
<a class="sourceLine" id="cb20-70" data-line-number="70"><span class="co">#&gt; 61599:  1.7346811 -0.1929194 -15.865267 -28.9438710 -20.8657566 -7.888523</span></a>
<a class="sourceLine" id="cb20-71" data-line-number="71"><span class="co">#&gt; 61600:  0.5324018 -1.6683637 -16.928378 -29.0730911 -18.5188139 -8.621436</span></a>
<a class="sourceLine" id="cb20-72" data-line-number="72"><span class="co">#&gt;                 O1        Oz         O2       HEOG      VEOG</span></a>
<a class="sourceLine" id="cb20-73" data-line-number="73"><span class="co">#&gt;     1: -3.65322157 -0.857261  0.8272414  0.3447419 11.224845</span></a>
<a class="sourceLine" id="cb20-74" data-line-number="74"><span class="co">#&gt;     2: -4.85519937 -2.340097 -0.7567453  0.4632065 10.759930</span></a>
<a class="sourceLine" id="cb20-75" data-line-number="75"><span class="co">#&gt;     3: -5.97389937 -3.806756 -2.3388557  0.5367955 10.289698</span></a>
<a class="sourceLine" id="cb20-76" data-line-number="76"><span class="co">#&gt;     4: -6.89709201 -5.103653 -3.7347525  0.5682565  9.816615</span></a>
<a class="sourceLine" id="cb20-77" data-line-number="77"><span class="co">#&gt;     5: -7.52750423 -6.086645 -4.7706429  0.5618662  9.343944</span></a>
<a class="sourceLine" id="cb20-78" data-line-number="78"><span class="co">#&gt;    ---                                                      </span></a>
<a class="sourceLine" id="cb20-79" data-line-number="79"><span class="co">#&gt; 61596:  3.18783151 -2.716008 -4.8848205 -7.2188242 45.591865</span></a>
<a class="sourceLine" id="cb20-80" data-line-number="80"><span class="co">#&gt; 61597:  2.59150349 -3.212819 -3.6260350 -7.3105804 42.675129</span></a>
<a class="sourceLine" id="cb20-81" data-line-number="81"><span class="co">#&gt; 61598:  1.80467585 -3.802984 -2.6252375 -7.1852110 40.065422</span></a>
<a class="sourceLine" id="cb20-82" data-line-number="82"><span class="co">#&gt; 61599:  0.93631430 -4.439382 -1.9579538 -6.8452634 37.764088</span></a>
<a class="sourceLine" id="cb20-83" data-line-number="83"><span class="co">#&gt; 61600:  0.07742928 -5.087588 -1.6836829 -6.2949585 35.770170</span></a>
<a class="sourceLine" id="cb20-84" data-line-number="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-85" data-line-number="85"><span class="co">#&gt; # Events table:</span></a>
<a class="sourceLine" id="cb20-86" data-line-number="86"><span class="co">#&gt;      .id    .type .description .initial .final .channel</span></a>
<a class="sourceLine" id="cb20-87" data-line-number="87"><span class="co">#&gt;   1:   1 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-88" data-line-number="88"><span class="co">#&gt;   2:   2 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-89" data-line-number="89"><span class="co">#&gt;   3:   3 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-90" data-line-number="90"><span class="co">#&gt;   4:   4 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-91" data-line-number="91"><span class="co">#&gt;   5:   5 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-92" data-line-number="92"><span class="co">#&gt;  ---                                                   </span></a>
<a class="sourceLine" id="cb20-93" data-line-number="93"><span class="co">#&gt; 196: 196 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-94" data-line-number="94"><span class="co">#&gt; 197: 197 Stimulus          s70        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-95" data-line-number="95"><span class="co">#&gt; 198: 198 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-96" data-line-number="96"><span class="co">#&gt; 199: 199 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-97" data-line-number="97"><span class="co">#&gt; 200: 200 Stimulus          s71        1      1     &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb20-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-99" data-line-number="99"><span class="co">#&gt; # Segments table:</span></a>
<a class="sourceLine" id="cb20-100" data-line-number="100"><span class="co">#&gt; # A tibble: 200 x 5</span></a>
<a class="sourceLine" id="cb20-101" data-line-number="101"><span class="co">#&gt;      .id .recording    segment description condition</span></a>
<a class="sourceLine" id="cb20-102" data-line-number="102"><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb20-103" data-line-number="103"><span class="co">#&gt;  1     1 s1_faces.vhdr       1 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-104" data-line-number="104"><span class="co">#&gt;  2     2 s1_faces.vhdr       2 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-105" data-line-number="105"><span class="co">#&gt;  3     3 s1_faces.vhdr       3 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-106" data-line-number="106"><span class="co">#&gt;  4     4 s1_faces.vhdr       4 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-107" data-line-number="107"><span class="co">#&gt;  5     5 s1_faces.vhdr       5 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-108" data-line-number="108"><span class="co">#&gt;  6     6 s1_faces.vhdr       6 s71         non-faces</span></a>
<a class="sourceLine" id="cb20-109" data-line-number="109"><span class="co">#&gt;  7     7 s1_faces.vhdr       7 s70         faces    </span></a>
<a class="sourceLine" id="cb20-110" data-line-number="110"><span class="co">#&gt;  8     8 s1_faces.vhdr       8 s70         faces    </span></a>
<a class="sourceLine" id="cb20-111" data-line-number="111"><span class="co">#&gt;  9     9 s1_faces.vhdr       9 s70         faces    </span></a>
<a class="sourceLine" id="cb20-112" data-line-number="112"><span class="co">#&gt; 10    10 s1_faces.vhdr      10 s70         faces    </span></a>
<a class="sourceLine" id="cb20-113" data-line-number="113"><span class="co">#&gt; # … with 190 more rows</span></a></code></pre></div>
<p>With some <code>ggplot</code> skills, we can create customized plots. <code>ggplot</code> is overloaded to work on an <code>eeg_lst</code> by first downsampling the signal when necessary, and converting it to a long-format data frame that is feed into <code>ggplot</code>. This object can then be customized. (Notice that the channels, or component names are in a <code>.key</code> column and their amplitude in <code>.value</code> column, and instead of samples there are now <code>.time</code> in seconds).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">## ggplot uses internally a table that looks like this:</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">faces_seg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(.id <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>()</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt; # A tibble: 31,416 x 8</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt;      .time   .id .recording    segment description condition .key  .value</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;      &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  1 -0.0996     1 s1_faces.vhdr       1 s71         non-faces Fp1   -0.720</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt;  2 -0.0977     1 s1_faces.vhdr       1 s71         non-faces Fp1    0.489</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt;  3 -0.0957     1 s1_faces.vhdr       1 s71         non-faces Fp1    1.71 </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt;  4 -0.0938     1 s1_faces.vhdr       1 s71         non-faces Fp1    2.77 </span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt;  5 -0.0918     1 s1_faces.vhdr       1 s71         non-faces Fp1    3.51 </span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt;  6 -0.0898     1 s1_faces.vhdr       1 s71         non-faces Fp1    3.83 </span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt;  7 -0.0879     1 s1_faces.vhdr       1 s71         non-faces Fp1    3.67 </span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt;  8 -0.0859     1 s1_faces.vhdr       1 s71         non-faces Fp1    3.04 </span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt;  9 -0.0840     1 s1_faces.vhdr       1 s71         non-faces Fp1    2.03 </span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">#&gt; 10 -0.0820     1 s1_faces.vhdr       1 s71         non-faces Fp1    0.773</span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">#&gt; # … with 31,406 more rows</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"></a>
<a class="sourceLine" id="cb21-18" data-line-number="18">faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(O1, O2, P7, P8) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .time, <span class="dt">y =</span> .value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">group =</span> .id, <span class="dt">color =</span> condition)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/stat_summary">stat_summary</a></span>(</a>
<a class="sourceLine" id="cb21-23" data-line-number="23">    <span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span> <span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb21-24" data-line-number="24">    <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color =</span> condition)</a>
<a class="sourceLine" id="cb21-25" data-line-number="25">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-26" data-line-number="26"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.key) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-27" data-line-number="27"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-28" data-line-number="28"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="fl">.17</span>, <span class="dt">linetype =</span> <span class="st">"dotted"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<p>We can see here the N170 component in the faces condition for the average trial on a single participant. We can investigate the signal by averaging the channels of the occipital and parietal lobes using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code>, and the special function, <code><a href="../reference/chs_mean.html">chs_mean()</a></code>, a wrapper for <code><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowMeans()</a></code>, which takes as arguments the relevant channels and whether missing values should be omitted from the calculations.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span>(</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">    <span class="dt">Occipital =</span> <span class="kw"><a href="../reference/chs_mean.html">chs_mean</a></span>(O1, O2, Oz, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">    <span class="dt">Parietal =</span> <span class="kw"><a href="../reference/chs_mean.html">chs_mean</a></span>(P3, P4, P7, P8, Pz, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .time, <span class="dt">y =</span> .value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">group =</span> .id, <span class="dt">color =</span> condition)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/stat_summary">stat_summary</a></span>(</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">    <span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span> <span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">    <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color =</span> condition)</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.key) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>We can also calculate the ERPs and then plot them in their layout (and we’ll add the same theme that plot uses for <code>eeg_lst</code>s):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">ERP_faces &lt;-<span class="st"> </span>faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(.sample, condition) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_at</a></span>(<span class="kw"><a href="../reference/summaries.html">channel_names</a></span>(.), mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">ERP_plot &lt;-<span class="st"> </span>ERP_faces <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .time, <span class="dt">y =</span> .value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color =</span> condition)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.key) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">"ERPs for faces vs non-faces"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="../reference/theme_eeguana.html">theme_eeguana</a></span>()</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">ERP_plot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_in_layout.html">plot_in_layout</a></span>()</a></code></pre></div>
<p><img src="intro_files/figure-html/layout-1.png" width="100%"></p>
<p>Another possibility is to create a topographic plot of the two conditions, by first making segments that include only the interval .1-.2 <em>s</em> after the onset of the stimuli, creating a table with interpolated amplitudes and using the ggplot wrapper <code><a href="../reference/plot_topo.html">plot_topo()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="../reference/between.html">between</a></span>(<span class="kw"><a href="../reference/as_time.html">as_time</a></span>(.sample, <span class="dt">unit =</span> <span class="st">"s"</span>), <span class="fl">.1</span>, <span class="fl">.2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(condition) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_at</a></span>(<span class="kw"><a href="../reference/summaries.html">channel_names</a></span>(.), mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/plot_topo.html">plot_topo</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/annotate_head.html">annotate_head</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_contour">geom_contour</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_text">geom_text</a></span>(<span class="dt">colour =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(<span class="op">~</span>condition)</a></code></pre></div>
<p><img src="intro_files/figure-html/topo-1.png" width="100%"></p>
<p>For more specialized plots or analyses, it might be necessary to extract the data in long data frame format first. Even though, we can do this without transforming the object, here, we transform the data first and then we visualize independent t-tests at every electrode and time point.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">df &lt;-<span class="st"> </span>faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(O1, O2, P7, P8) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="co"># We can use regular dplyr functions now</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(.key, .time) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">    <span class="st">`</span><span class="dt">t-value</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">      .value[condition <span class="op">==</span><span class="st"> "faces"</span>],</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">      .value[condition <span class="op">==</span><span class="st"> "non-faces"</span>]</a>
<a class="sourceLine" id="cb25-10" data-line-number="10">    )<span class="op">$</span>statistic</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb25-12" data-line-number="12"></a>
<a class="sourceLine" id="cb25-13" data-line-number="13">df</a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">#&gt; # A tibble: 1,232 x 3</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#&gt; # Groups:   .key [4]</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">#&gt;    .key    .time `t-value`</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18"><span class="co">#&gt;  1 O1    -0.0996    0.249 </span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="co">#&gt;  2 O1    -0.0977    0.273 </span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co">#&gt;  3 O1    -0.0957    0.279 </span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="co">#&gt;  4 O1    -0.0938    0.259 </span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co">#&gt;  5 O1    -0.0918    0.204 </span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="co">#&gt;  6 O1    -0.0898    0.110 </span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="co">#&gt;  7 O1    -0.0879   -0.0304</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="co">#&gt;  8 O1    -0.0859   -0.221 </span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="co">#&gt;  9 O1    -0.0840   -0.459 </span></a>
<a class="sourceLine" id="cb25-27" data-line-number="27"><span class="co">#&gt; 10 O1    -0.0820   -0.733 </span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28"><span class="co">#&gt; # … with 1,222 more rows</span></a></code></pre></div>
<p>Then we just load the data frame into <code>ggplot</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(df, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .time, <span class="dt">y =</span> <span class="st">`</span><span class="dt">t-value</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.key)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
<p>However, this can be also done in the without transforming the <code>eeg_lst</code> object:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">faces_seg_t &lt;-</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span>faces_seg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(O1, O2, P7, P8) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(.sample) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_at</a></span>(<span class="kw"><a href="../reference/summaries.html">channel_names</a></span>(.), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">t =</span>  <span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">    .[condition <span class="op">==</span><span class="st"> "faces"</span>],</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">    .[condition <span class="op">==</span><span class="st"> "non-faces"</span>]</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  )<span class="op">$</span>statistic))</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"></a>
<a class="sourceLine" id="cb27-10" data-line-number="10">faces_seg_t <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .time, <span class="dt">y =</span> .value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">group =</span> .id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/stat_summary">stat_summary</a></span>(<span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span> <span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.key) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-20-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#working-with-eeguana">Working with eeguana</a></li>
      <li>
<a href="#a-practical-example-the-n170-effect">A practical example: the N170 effect</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pre-processing">Pre-processing</a></li>
      <li><a href="#filtering">Filtering</a></li>
      <li><a href="#ica">ICA</a></li>
      <li><a href="#visualization">Visualization</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.ling.uni-potsdam.de/~nicenboim/">Bruno Nicenboim</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
